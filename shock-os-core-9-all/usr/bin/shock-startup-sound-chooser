#!/bin/bash

directory="~/"

while true
do

    cd "$directory"

    file="$(yad --window-icon=gnome-music --title="Startup Sound" --text="Please select an audio file to use as the startup sound." --file --buttons-layout=edge --button="Reset to Default"\!edit-undo:2 --button="Choose"\!fileopen:0)"

    ex=$?

    if ((ex==0))
    then

        directory="$(dirname "$file")"

        if [[ " $(file "$file" | awk '{print tolower($0)}')" == *" audio"* ]]
        then

            mkdir -p ~/.shock

            cp "$file" ~/.shock/startup-sound

            yad --window-icon=gnome-music --image=emblem-default --title="Startup Sound" --text="'$(basename "$file")' has been set as the startup sound." --button="Dismiss"\!gtk-cancel

            exit

        else

            yad --window-icon=gnome-music --image=emblem-important --title="Startup Sound" --text="The selected file does not appear to be an audio file. Please select an audio file." --button="Retry"\!edit-undo

            ex=$?

            if ((ex!=0))
            then

                exit

            fi

        fi

    elif ((ex==2))
    then

        rm ~/.shock/startup-sound

        yad --window-icon=gnome-music --image=emblem-default --title="Startup Sound" --text="The startup sound has been reset to the default." --button="Dismiss"\!gtk-cancel

        exit

    else

        exit

    fi

done
