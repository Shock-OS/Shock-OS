#!/bin/bash

#the root check element begins

if [[ "$(id -u)" != "0" ]]
then

    echo "Script must be run as root. Exiting..."

fi

#the root check element ends

if [[ -f /etc/sudoers.d/shock_automatic_updates ]]
then

    yad --window-icon=emblem-synchronizing --title="Automatic Updates" --text="Automatic updates are already enabled. Would you like to disable automatic updates?" --button="Disable Automatic Updates" --button="Cancel"

    dau=$?

    if [[ "$dau" == "0" ]]
    then

        sudo rm /etc/sudoers.d/shock_automatic_updates

        yad --window-icon=emblem-synchronizing --title="Automatic Updates" --text="Automatic updates have been disabled." --button="Dismiss"

    fi

else

    yad --window-icon=emblem-synchronizing --width=700 --title="Automatic Updates" --text="Automatic updates are run as root daily if the internet connection is stable. You will not be able to install or remove APT packages while automatic updates are being applied. You will also not be able to shutdown or logout while automatic updates are being applied. Would you like to enable automatic updates?" --button="Enable Automatic Updates" --button="Cancel"

    eau=$?

    if [[ "$eau" != "0" ]]
    then

        exit

    fi

    sudo echo '# Allow any user to run automatic updates without requiring a password

%sudo ALL = NOPASSWD:/usr/bin/shock-auto-updates' | sudo EDITOR='tee' visudo -f /etc/sudoers.d/shock_automatic_updates

    yad --window-icon=emblem-synchronizing --title="Automatic Updates" --text="Automatic updates are now enabled and will be run as root on a daily basis." --button="Dismiss"

fi






    
