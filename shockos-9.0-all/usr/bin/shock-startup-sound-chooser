#!/bin/bash

directory="~/"

while true
do

    cd "$directory"

    file="$(yad --window-icon=sound --title="Startup Sound" --text="Please select an audio file to use as the startup sound." --file --buttons-layout=edge --button="Reset to Default"\!gtk-revert:2 --button="Cancel"\!gtk-cancel:1 --button="Choose"\!fileopen:0)"

    ex=$?

    if ((ex==0))
    then

        directory="$(dirname "$file")"

        if [[ "$(file "$file")" == *"Audio file"* ]]
        then

            mkdir -p ~/.shock

            cp "$file" ~/.shock/startup-sound

            yad --window-icon=sound --image=emblem-default --title="Startup Sound" --text="'$(basename "$file")' has been set as the startup sound." --button="Dismiss"\!gtk-quit

            exit

        else

            yad --window-icon=sound --image=emblem-important --title="Startup Sound" --text="The selected file does not appear to be an audio file. Please select an audio file." --button="Retry"\!edit-undo

            ex=$?

            if ((ex!=0))
            then

                exit

            fi

        fi

    elif ((ex==2))
    then

        rm ~/.shock/startup-sound

        yad --window-icon=sound --image=emblem-default --title="Startup Sound" --text="The startup sound has been reset to the default." --button="Dismiss"\!gtk-quit

        exit

    else

        exit

    fi

done
