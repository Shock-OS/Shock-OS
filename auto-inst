#!/bin/bash

#this script installs the Shock OS .deb in the current directory

until [[ " ${installed_packages[@]} " == *" pipewire-audio "* ]]
do

    sudo apt update

    sudo apt install -y pipewire-audio

    installed_packages=($(apt list --installed | awk -F/ '{print $1}' | uniq)) #ChatGPT

done

until [[ " ${installed_packages[@]} " == *" shock-os-core "* ]]
do

    sudo apt install -y ./shock-os-core_*

    installed_packages=($(apt list --installed | awk -F/ '{print $1}' | uniq)) #ChatGPT

done

if (($(getconf LONG_BIT)==32))
then

    arch="armhf"

else

    arch="arm64"

fi

until [[ " ${installed_packages[@]} " == *" appimagelauncher "* ]]
do

    sudo apt install -y /usr/share/shock/appimagelauncher/*_"$arch".deb

    installed_packages=($(apt list --installed | awk -F/ '{print $1}' | uniq)) #ChatGPT

done

rm -r /usr/share/shock/appimagelauncher

until [[ " ${installed_packages[@]} " == *" shock-os-mate-desktop "* ]] || [[ " ${installed_packages[@]} " == *" shock-os-gnome-desktop "* ]]
do

    sudo apt install -y ./shock-os-*-desktop_*

    installed_packages=($(apt list --installed | awk -F/ '{print $1}' | uniq)) #ChatGPT

done

sudo apt update

sudo apt purge -y xterm #gets rid of xterm

sudo apt autopurge -y

sudo apt update

sudo shock-update-manager-refresh
